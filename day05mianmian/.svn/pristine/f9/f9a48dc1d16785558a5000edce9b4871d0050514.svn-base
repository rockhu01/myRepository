package com.hu.mm.service;

import com.hu.mm.dao.UserDao;
import com.hu.mm.pojo.User;
import com.hu.pojo.utils.SqlSessionFactoryUtils;
import org.apache.ibatis.session.SqlSession;
import org.apache.ibatis.session.SqlSessionFactory;

import java.io.IOException;

/**
 * Project：ssm
 * Date：2019/12/31
 * Time：18:55
 * Description：TODO
 *
 * @author huxiongjun
 * @version 1.0
 */
public class UserService {

    /**
     * 用户登录
     * @param loginUser
     * @return
     * @throws IOException
     */
    public User login(User loginUser) throws IOException {
        //1.0使用Mybatis 调用dao查询数据库
        SqlSession sqlSession = SqlSessionFactoryUtils.openSqlSession();
        UserDao userDao = sqlSession.getMapper(UserDao.class);
        //调用查询用户方法
        User user = userDao.findUserByUsername(loginUser);
        //关闭sqlSession,释放资源
        SqlSessionFactoryUtils.commitAndClose(sqlSession);
        //2.0 处理业务,通过比较两者的密码是否相同来判定是否登陆成功
        if(user != null && user.getPassword().equals(loginUser.getPassword())){
            return user;
        }
        return null;
    }
}
